{% extends "base.html" %}

{% block content %}
<div class="hero-section text-center py-5 mb-5 bg-success text-white rounded-bottom shadow">
    <div class="container">
        <h1 class="display-4 fw-bold">ğŸšœ áƒ˜áƒáƒáƒ•áƒ” áƒ¡áƒáƒ£áƒ™áƒ”áƒ—áƒ”áƒ¡áƒ áƒáƒ’áƒ áƒáƒ¢áƒ”áƒ¥áƒœáƒ˜áƒ™áƒ</h1>
        <p class="lead">áƒ’áƒáƒáƒ¥áƒ˜áƒ áƒáƒ•áƒ” áƒáƒœ áƒ˜áƒ¥áƒ˜áƒ áƒáƒ•áƒ” áƒ¡áƒáƒ¡áƒáƒ¤áƒšáƒ-áƒ¡áƒáƒ›áƒ”áƒ£áƒ áƒœáƒ”áƒ áƒ¢áƒ”áƒ¥áƒœáƒ˜áƒ™áƒ áƒ›áƒáƒ áƒ¢áƒ˜áƒ•áƒáƒ“</p>

        <div class="row justify-content-center mt-4">
            <div class="col-md-8">
                <form action="{{ url_for('index') }}" method="GET" class="d-flex shadow-lg rounded-pill overflow-hidden bg-white p-1">
                    <input type="text" name="search" class="form-control border-0 px-4 py-3"
                           placeholder="áƒ áƒ áƒ¢áƒ˜áƒáƒ˜áƒ¡ áƒ¢áƒ”áƒ¥áƒœáƒ˜áƒ™áƒáƒ¡ áƒ”áƒ«áƒ”áƒ‘áƒ—? (áƒ›áƒáƒ’: áƒ¢áƒ áƒáƒ¥áƒ¢áƒáƒ áƒ˜, áƒ’áƒ£áƒ—áƒáƒœáƒ˜...)"
                           value="{{ request.args.get('search', '') }}">
                    <button type="submit" class="btn btn-dark px-4 py-2 rounded-pill m-1">
                        <i class="bi bi-search"></i> áƒ«áƒ”áƒ‘áƒœáƒ
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="d-flex justify-content-center gap-3 mb-5 flex-wrap">
        <a href="/?search=áƒ¢áƒ áƒáƒ¥áƒ¢áƒáƒ áƒ˜" class="btn btn-outline-success rounded-pill shadow-sm">ğŸšœ áƒ¢áƒ áƒáƒ¥áƒ¢áƒáƒ áƒ”áƒ‘áƒ˜</a>
        <a href="/?search=áƒ™áƒáƒ›áƒ‘áƒáƒ˜áƒœáƒ˜" class="btn btn-outline-success rounded-pill shadow-sm">ğŸŒ¾ áƒ™áƒáƒ›áƒ‘áƒáƒ˜áƒœáƒ”áƒ‘áƒ˜</a>
        <a href="/?search=áƒ›áƒ˜áƒœáƒ˜" class="btn btn-outline-success rounded-pill shadow-sm">ğŸšœ áƒ›áƒ˜áƒœáƒ˜ áƒ¢áƒ”áƒ¥áƒœáƒ˜áƒ™áƒ</a>
        <a href="/" class="btn btn-outline-secondary rounded-pill shadow-sm">áƒ§áƒ•áƒ”áƒšáƒ</a>
    </div>

    <div class="row">
        {% for m in machines %}
            <div class="col-md-4 mb-4">
                <div class="card h-100 shadow border-0 card-hover">
                    <div class="position-relative">
                        <img src="{{ url_for('static', filename='uploads/' + m.image_file) }}"
                             class="card-img-top" alt="{{ m.name }}"
                             style="height: 230px; object-fit: cover;">
                        <span class="badge bg-primary position-absolute top-0 end-0 m-3 p-2 shadow price-tag-badge">
                            {{ m.price }} â‚¾ / áƒ“áƒ¦áƒ”
                        </span>
                    </div>

                    <div class="card-body d-flex flex-column">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h5 class="card-title text-dark fw-bold mb-0">{{ m.name }}</h5>
                            <span class="badge bg-light text-success border border-success small">{{ m.category }}</span>
                        </div>

                        <p class="text-muted small mt-2 mb-3 flex-grow-1">
                            {% if m.description %}
                                {{ m.description[:100] }}{% if m.description|length > 100 %}...{% endif %}
                            {% else %}
                                <span class="fst-italic">áƒáƒ¦áƒ¬áƒ”áƒ áƒ áƒáƒ  áƒáƒ áƒ˜áƒ¡ áƒ›áƒ˜áƒ—áƒ˜áƒ—áƒ”áƒ‘áƒ£áƒšáƒ˜.</span>
                            {% endif %}
                        </p>

                        <p class="small text-muted mb-3">
                            <i class="bi bi-person"></i> áƒ›áƒ¤áƒšáƒáƒ‘áƒ”áƒšáƒ˜: <strong>{{ m.owner.username }}</strong>
                        </p>

                        <div class="d-flex gap-2">
                            <a href="{{ url_for('machine_details', machine_id=m.id) }}" class="btn btn-success flex-grow-1 shadow-sm font-weight-bold">áƒ“áƒ”áƒ¢áƒáƒšáƒ”áƒ‘áƒ˜</a>

                            {% if current_user.is_authenticated %}
                                {% if m.owner == current_user or current_user.is_admin %}
                                    <div class="dropdown">
                                        <button class="btn btn-outline-secondary dropdown-toggle shadow-sm" type="button" data-bs-toggle="dropdown"></button>
                                        <ul class="dropdown-menu shadow border-0">
                                            <li><a class="dropdown-item text-warning" href="{{ url_for('edit_machine', machine_id=m.id) }}">ğŸ“ áƒ áƒ”áƒ“áƒáƒ¥áƒ¢áƒ˜áƒ áƒ”áƒ‘áƒ</a></li>
                                            <li><hr class="dropdown-divider"></li>
                                            <li>
                                                <form action="{{ url_for('delete_machine', machine_id=m.id) }}" method="POST">
                                                    <button class="dropdown-item text-danger" onclick="return confirm('áƒ“áƒáƒ áƒ¬áƒ›áƒ£áƒœáƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ®áƒáƒ áƒ—, áƒ áƒáƒ› áƒ’áƒ¡áƒ£áƒ áƒ— áƒ¬áƒáƒ¨áƒšáƒ?')">ğŸ—‘ï¸ áƒ¬áƒáƒ¨áƒšáƒ</button>
                                                </form>
                                            </li>
                                        </ul>
                                    </div>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        {% else %}
            <div class="col-12 text-center py-5">
                <i class="bi bi-search text-muted display-1"></i>
                <h3 class="mt-3 text-muted">áƒ¢áƒ”áƒ¥áƒœáƒ˜áƒ™áƒ áƒ•áƒ”áƒ  áƒ›áƒáƒ˜áƒ«áƒ”áƒ‘áƒœáƒ</h3>
                <a href="{{ url_for('index') }}" class="btn btn-success mt-2 rounded-pill px-4">áƒ§áƒ•áƒ”áƒšáƒ áƒ’áƒáƒœáƒªáƒ®áƒáƒ“áƒ”áƒ‘áƒ˜áƒ¡ áƒœáƒáƒ®áƒ•áƒ</a>
            </div>
        {% endfor %}
    </div>

    <footer class="mt-5 py-5 border-top">
        <div class="container text-center">
            <p class="text-muted small mb-3">áƒáƒ áƒáƒ”áƒ¥áƒ¢áƒ˜ áƒ®áƒáƒ áƒªáƒ˜áƒ”áƒšáƒ“áƒ”áƒ‘áƒ áƒ›áƒ®áƒáƒ áƒ“áƒáƒ­áƒ”áƒ áƒ˜áƒ—:</p>
            <a href="https://www.tbceducation.ge/" target="_blank" class="d-inline-block">
                <img src="{{ url_for('static', filename='uploads/TBC Logo.png') }}"
                     alt="TBC Logo"
                     class="tbc-footer-logo">
            </a>
            <div class="mt-4">
                <p class="text-muted small">&copy; 2026 áƒáƒ’áƒ áƒáƒ¢áƒ”áƒ¥áƒœáƒ˜áƒ™áƒ˜áƒ¡ áƒ’áƒáƒ¥áƒ˜áƒ áƒáƒ•áƒ”áƒ‘áƒ</p>
            </div>
        </div>
    </footer>
</div>

<style>
    /* Body & Layout */
    body {
        background-color: #f4f7f6;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    /* Hero Section */
    .hero-section {
        background: linear-gradient(135deg, #198754 0%, #0d5c36 100%);
        border-radius: 0 0 50px 50px;
    }

    /* Card Styling */
    .card {
        border-radius: 15px;
        overflow: hidden;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .card-hover:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 35px rgba(0,0,0,0.15) !important;
    }

    .price-tag-badge {
        font-weight: bold;
        font-size: 1rem;
    }

    .rounded-pill { border-radius: 50px !important; }

    /* Footer & TBC Logo */
    .tbc-footer-logo {
        height: 70px;
        width: auto;
        filter: grayscale(100%);
        opacity: 0.7;
        transition: all 0.4s ease;
    }

    .tbc-footer-logo:hover {
        filter: grayscale(0%);
        opacity: 1;
        transform: scale(1.05);
    }
</style>
{% endblock %}